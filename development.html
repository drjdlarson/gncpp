<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Development Tips and Tricks &mdash; GNCPy C++ 0.2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
    <link rel="canonical" href="https://drjdlarson.github.io/gncpy_cpp/development.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="References.html" />
    <link rel="prev" title="CI/CD Pipeline" href="cicd.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #9E1B32" >

          
          
          <a href="index.html" class="icon icon-home">
            GNCPy C++
              <img src="_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#installing-the-ide">Installing the IDE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Quickstart.html#extra-information-on-docker">Extra information on Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#getting-the-code">Getting the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#development">Development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Quickstart.html#building-and-testing-the-code">Building and testing the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="Quickstart.html#creating-a-release">Creating a Release</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cicd.html">CI/CD Pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cicd.html#github-actions-quick-guide">Github Actions Quick Guide</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Development Tips and Tricks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#automated-releases">Automated Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unit-tests">Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#serialization">Serialization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#add-serialization-to-a-class">Add Serialization to a class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="./api/index.html#http://">Library API</a></li>
<li class="toctree-l1"><a class="reference external" href="./reports/coverage/coverage.html#http://">Test Coverage Report</a></li>
<li class="toctree-l1"><a class="reference external" href="./reports/junit/junit.html#http://">Test Results Report</a></li>
<li class="toctree-l1"><a class="reference internal" href="References.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #9E1B32" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GNCPy C++</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Development Tips and Tricks</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="development-tips-and-tricks">
<h1>Development Tips and Tricks<a class="headerlink" href="#development-tips-and-tricks" title="Permalink to this heading"></a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#automated-releases" id="id1">Automated Releases</a></p></li>
<li><p><a class="reference internal" href="#unit-tests" id="id2">Unit Tests</a></p></li>
<li><p><a class="reference internal" href="#serialization" id="id3">Serialization</a></p>
<ul>
<li><p><a class="reference internal" href="#add-serialization-to-a-class" id="id4">Add Serialization to a class</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>The following subsections include some lessons learned and tips to keep in mind when developing for this library. They don’t need to be strictly followed but may be helpful when developing or debugging the code.</p>
<p>In general, all development should be done on a branch and squash merged into the master branch after the feature is developed and tests added. After enough features have been added, a release can be created (following semantic versioning for version numbers).</p>
<section id="automated-releases">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Automated Releases</a><a class="headerlink" href="#automated-releases" title="Permalink to this heading"></a></h2>
<p>When a new release is required, a helper script is available to automate the process. To use this script, make sure all conent for the release has been merged to master and pushed to the remote (i.e. github). Checkout to the master branch on your local PC, make sure you are up to date (i.e. run <code class="code docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code>), then run <code class="code docutils literal notranslate"><span class="pre">python</span> <span class="pre">do_release.py</span></code> from the root of the repository. This script requires you to specify if it is a major, minor, or patch release. Major versions introduce API changes that break backwards compatibility, minor versions introduce new features in a non-API breaking fashion, and patch versions are non-API breaking bug fixes. This script will automatically increment the appropriate version number in <strong>include/gncpy/core.h</strong>, make a commit, create a tag with the version number, and push the commit and tag to the remote (i.e. github). Once the tag gets pushed, the CI/CD pipeline takes over on github to finish the release.</p>
</section>
<section id="unit-tests">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Unit Tests</a><a class="headerlink" href="#unit-tests" title="Permalink to this heading"></a></h2>
<p>The unit tests are found within the <strong>test/unit</strong> folder, and subdirectories have been created to mimic the include paths. The top level (<strong>test/unit</strong>) has a CMakeLists.txt file that adds all the subdirectories and any top level tests. Within each subdirectory, there is another CMakeLists.txt that controls how the tests are created for that directory.</p>
<p>When adding a new set of tests, create a new file in the appropriate location, add the test to the CMakeLists.txt file within that directory, and finally, update the CMakeLists.txt file at the root of the repo. The CMakeLists.txt at the root of the repo has special targets for the code coverage that have dependencies on all the unit tests. When you add a new file to the test suite, you need to add this target to the list of dependencies for the code coverage targets at the root of the repo.</p>
</section>
<section id="serialization">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Serialization</a><a class="headerlink" href="#serialization" title="Permalink to this heading"></a></h2>
<p>The <a class="reference external" href="https://uscilab.github.io/cereal/">cereal</a> library is used for serialization and some helper macros have be defined in <strong>include/gncpy/SerializeMacros.h</strong> to reduce the boilerplate for adding serialization to a class.</p>
<section id="add-serialization-to-a-class">
<h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Add Serialization to a class</a><a class="headerlink" href="#add-serialization-to-a-class" title="Permalink to this heading"></a></h3>
<p>To add serialization to a typical class keep the following in mind.</p>
<ol class="arabic">
<li><p>Include the serialization macros header from gncpy</p></li>
<li><p>Include any archive types from cereal (these can come from the include chain if a parent class already includes them)</p></li>
<li><p>Include <code class="code docutils literal notranslate"><span class="pre">cereal/access.hpp</span></code> and give friend access to the <code class="code docutils literal notranslate"><span class="pre">cereal::access</span></code> class</p></li>
<li><p>If the class is polymorphic (i.e. there is a virtual function or pointers to a base class can also represent child classes) include <code class="code docutils literal notranslate"><span class="pre">cereal/types/polymorphic.hpp</span></code></p></li>
<li><p>If the class is a child of another serializable class include <code class="code docutils literal notranslate"><span class="pre">cereal/types/base_class.hpp</span></code></p></li>
<li><p>Some other cereal headers may be required to serialize specific data types (consult their <a class="reference external" href="https://uscilab.github.io/cereal/">documentation</a> for details)</p></li>
<li><p>A public construct that takes no arguments is required (this can be defaulted)</p></li>
<li><p>The <code class="code docutils literal notranslate"><span class="pre">GNCPY_SERIALIZE_CLASS</span></code> macro should be used within the class body (but not nested inside any public/private/protected sections) to provide the following methods (this requires <code class="code docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;sstream&gt;`in</span> <span class="pre">the</span> <span class="pre">current</span> <span class="pre">header</span> <span class="pre">and</span> <span class="pre">:code:`#include</span> <span class="pre">&lt;cereal/archives/portable_binary.hpp&gt;</span></code> in the include chain). If the class can not be instantiated then this macro should not be used and is not needed.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">saveClassState</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">static</span> <span class="pre">loadClass</span></code> This can be called without instantiating a class and will return an instance of the class.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">toJSON</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">createOutputArchive</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">static</span> <span class="pre">createInputArchive</span></code> This needs to be static because it is called when loading the class</p></li>
</ul>
</div></blockquote>
</li>
<li><p>For template classes a helper macro, <code class="code docutils literal notranslate"><span class="pre">GNCPY_REGISTER_SERIALIZE_TYPES</span></code>, can be used to automaically register different variations of the template class with cereal. It should be used outside any namespace and the full class name (i.e. all the namespaces and class name but without the template parameter) should be supplied.</p></li>
<li><p>For non-template classes, the class should be directly registered with cereal following similar guidelines as the helper macro (i.e. outside any namespace, pass the class name with all preceeding namespaces, etc.)</p></li>
<li><p>Note that anonymous functions and <code class="code docutils literal notranslate"><span class="pre">std::function</span></code> can <strong>not</strong> be serialized.</p></li>
<li><p>A template specialization for the class should be provided in the private section of the class. <code class="code docutils literal notranslate"><span class="pre">template</span> <span class="pre">&lt;class</span> <span class="pre">Archive&gt;</span> <span class="pre">void</span> <span class="pre">serialize(Archive&amp;</span> <span class="pre">ar)</span></code>. This should use <code class="code docutils literal notranslate"><span class="pre">CEREAL_NVP</span></code> around any class values and <code class="code docutils literal notranslate"><span class="pre">cereal::make_nvp</span></code> around any base classes to give appropriate names in the JSON form. Additionally, if it is a child class the base class should be passed to the archive using <code class="code docutils literal notranslate"><span class="pre">cereal::virtual_base_class&lt;baseClass_t&gt;(this)</span></code> where <code class="code docutils literal notranslate"><span class="pre">baseClass_t</span></code> is replaced by the appropriate base class.</p></li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cicd.html" class="btn btn-neutral float-left" title="CI/CD Pipeline" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="References.html" class="btn btn-neutral float-right" title="References" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Laboratory for Autonomy, GNC, and Estimation Research (LAGER).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>